{"@odata.context":"https://devops-search.search.windows.net/indexes('jira-iac-index')/$metadata#docs(*)","value":[{"@search.score":1.0,"id":"3","content":"# Subnets\r\ndata \"azurerm_subnet\" \"subnet\" {\r\n  resource_group_name  = \"eis-devtest-int-southwest-network-rg\"\r\n  name                 = \"N800-Subnet-01\"\r\n  virtual_network_name = \"EIS-DEVTEST-SOUTHWEST\"\r\n}\r\n\r\ndata \"azurerm_subnet\" \"sql-subnet\" {\r\n  resource_group_name  = \"eis-devtest-int-southwest-network-rg\"\r\n  name                 = \"N54CA-Subnet-04\"\r\n  virtual_network_name = \"EIS-DEVTEST-SOUTHWEST\"\r\n}\r\n\r\ndata \"azurerm_subnet\" \"appgw-subnet\" {\r\n  resource_group_name  = \"eis-devtest-int-southwest-network-rg\"\r\n  name                 = \"N709-SUBNET-01\"\r\n  virtual_network_name = \"EIS-DEVTEST-SOUTHWEST\"\r\n}\r\n#IP\r\ndata \"azurerm_public_ip\" \"appgw-pip\" {\r\n  name                = \"EIS-SOUTHWEST-PIP0\"\r\n  resource_group_name = \"EIS-INT-SOUTHWEST-RG\"\r\n}","vector":[0.3,0.4,0.5]},{"@search.score":1.0,"id":"9","content":"variable \"SQL_SERVER_PASSWORD\" {\r\n  type        = string\r\n  sensitive   = true\r\n  description = \"SQL Server Admin Password\"\r\n}\r\n\r\nvariable \"SSL_PASSWORD\" {\r\n  type        = string\r\n  sensitive   = true\r\n  description = \"SSL Password\"\r\n}","vector":[0.9,0.1,0.11]},{"@search.score":1.0,"id":"2","content":"resource \"azurerm_application_gateway\" \"appgw\" {\r\n  name                = \"vac20gateissonarqube\"\r\n  resource_group_name = azurerm_resource_group.sonarqube.name\r\n  tags                = local.devtesttags\r\n\r\n  sku {\r\n    name     = \"Standard_v2\"\r\n    tier     = \"Standard_v2\"\r\n    capacity = 2\r\n  }\r\n\r\n  gateway_ip_configuration {\r\n    name      = \"appgw-ip-config\"\r\n    subnet_id = data.azurerm_subnet.appgw-subnet.id\r\n  }\r\n\r\n  frontend_ip_configuration {\r\n    name                 = \"appgw-frontend-ip\"\r\n    public_ip_address_id = data.azurerm_public_ip.appgw-pip.id\r\n  }\r\n\r\n  frontend_ip_configuration {\r\n    name                          = \"appgw-frontend-ip-private\"\r\n    subnet_id                     = data.azurerm_subnet.appgw-subnet.id\r\n    private_ip_address_allocation = \"Static\"\r\n    private_ip_address            = \"10.111.111.158\"\r\n  }\r\n\r\n  frontend_port {\r\n    name = \"http\"\r\n    port = 80\r\n  }\r\n\r\n  frontend_port {\r\n    name = \"https\"\r\n    port = 443\r\n  }\r\n\r\n  backend_address_pool {\r\n    name         = \"backend-pool\"\r\n    ip_addresses = [azurerm_container_group.aci.ip_address]\r\n  }\r\n\r\n  backend_http_settings {\r\n    name                                = \"sonar_backend\"\r\n    cookie_based_affinity               = \"Disabled\"\r\n    port                                = 9000\r\n    protocol                            = \"Http\"\r\n    path                                = \"/\"\r\n    request_timeout                     = 60\r\n    pick_host_name_from_backend_address = true\r\n  }\r\n\r\n  ssl_certificate {\r\n    name     = \"sonar_2025_cert\"\r\n    data     = filebase64(\"sonar.2025.pfx\")\r\n    password = var.SSL_PASSWORD\r\n  }\r\n\r\n  ssl_certificate {\r\n    name     = \"sonar_2024_cert\"\r\n    data     = filebase64(\"sonar.2024.pfx\")\r\n    password = var.SSL_PASSWORD\r\n  }\r\n\r\n  ssl_policy {\r\n    policy_type = \"Predefined\"\r\n    policy_name = \"AppGwSslPolicy101\"\r\n  }\r\n\r\n  /* trusted_client_certificate {\r\n    name = \"root_cert\"\r\n    data = filebase64(\"ssl.cer\")\r\n  } */\r\n\r\n  http_listener {\r\n    name                           = \"http-listener\"\r\n    frontend_ip_configuration_name = \"appgw-frontend-ip-private\"\r\n    frontend_port_name             = \"http\"\r\n    protocol                       = \"Http\"\r\n  }\r\n\r\n  http_listener {\r\n    name                           = \"https-listener\"\r\n    frontend_ip_configuration_name = \"appgw-frontend-ip-private\"\r\n    frontend_port_name             = \"https\"\r\n    protocol                       = \"Https\"\r\n    host_name                      = \"sonar.com\"\r\n    ssl_certificate_name           = \"sonar_2025_cert\"\r\n  }\r\n\r\n  request_routing_rule {\r\n    priority                   = \"10\"\r\n    name                       = \"http-rule\"\r\n    rule_type                  = \"Basic\"\r\n    http_listener_name         = \"http-listener\"\r\n    backend_address_pool_name  = \"backend-pool\"\r\n    backend_http_settings_name = \"sonar_backend\"\r\n  }\r\n\r\n  request_routing_rule {\r\n    priority                   = \"1\"\r\n    name                       = \"https-rule\"\r\n    rule_type                  = \"Basic\"\r\n    http_listener_name         = \"https-listener\"\r\n    backend_address_pool_name  = \"backend-pool\"\r\n    backend_http_settings_name = \"sonar_backend\"\r\n  }\r\n}","vector":[0.2,0.3,0.4]},{"@search.score":1.0,"id":"4","content":"locals {\r\n  \r\n  devtesttags = {\r\n    CKID           = \"195\"\r\n    Environment    = \"DEVTEST\"\r\n    ProjectName    = \"SQ Integration Solution\"\r\n  \r\n  }\r\n}","vector":[0.4,0.5,0.6]},{"@search.score":1.0,"id":"5","content":"resource \"azurerm_resource_group\" \"sonarqube\" {\r\n  name     = \"EIS-DEVTEST-SONARQUBE-RG\"\r\n  tags     = local.devtesttags\r\n}","vector":[0.5,0.6,0.7]},{"@search.score":1.0,"id":"11","content":"what is the min_tls_version used for the storage accounts?\r\n\r\nwhat is the name of the sonarqube resource group and its location?\r\n\r\nwhat firewall rules are applied?\r\n\r\nwhat is the version and login details for the sql server database used in sonarqube project?","vector":[0.11,0.12,0.13]},{"@search.score":1.0,"id":"7","content":"resource \"azurerm_mssql_firewall_rule\" \"allow_azure_services\" {\r\n  name             = \"AzureServices\"\r\n  server_id        = azurerm_mssql_server.db-server.id\r\n  start_ip_address = \"0.0.0.0\"\r\n  end_ip_address   = \"0.0.0.0\"\r\n}\r\n\r\nresource \"azurerm_mssql_server\" \"db-server\" {\r\n  name                         = \"sonarqube-sql-server\"\r\n  resource_group_name          = azurerm_resource_group.sonarqube.name\r\n  location                     = local.location\r\n  version                      = \"12.0\"\r\n  administrator_login          = \"4dm1n157r470r\"\r\n  administrator_login_password = var.SQL_SERVER_PASSWORD\r\n  tags                         = local.devtesttags\r\n  minimum_tls_version          = \"1.2\"\r\n}\r\n\r\nresource \"azurerm_mssql_database\" \"db\" {\r\n  name           = \"sonarqubedb\"\r\n  server_id      = azurerm_mssql_server.db-server.id\r\n  collation      = \"SQL_Latin1_General_CP1_CS_AS\"\r\n  license_type   = \"LicenseIncluded\"\r\n  max_size_gb    = 2\r\n  sku_name       = \"S0\"\r\n  enclave_type   = \"VBS\"\r\n  zone_redundant = true\r\n  tags           = local.devtesttags\r\n\r\n  short_term_retention_policy {\r\n    retention_days = 14\r\n  }\r\n\r\n  long_term_retention_policy {\r\n    weekly_retention = \"PT0S\"\r\n  }\r\n\r\n  lifecycle {\r\n    prevent_destroy = true\r\n  }\r\n}\r\n\r\nresource \"azurerm_mssql_virtual_network_rule\" \"sql-rule\" {\r\n  name      = \"sql-vnet-rule\"\r\n  server_id = azurerm_mssql_server.db-server.id\r\n  subnet_id = data.azurerm_subnet.sql-subnet.id\r\n}\r\n\r\nresource \"azurerm_mssql_database_extended_auditing_policy\" \"sonarqube\" {\r\n  database_id                             = azurerm_mssql_database.db.id\r\n  storage_endpoint                        = azurerm_storage_account.sonarqube.primary_blob_endpoint\r\n  storage_account_access_key              = azurerm_storage_account.sonarqube.primary_access_key\r\n  storage_account_access_key_is_secondary = false\r\n  retention_in_days                       = 90\r\n}\r\n\r\nresource \"azurerm_mssql_server_security_alert_policy\" \"sonarqube\" {\r\n  resource_group_name        = azurerm_resource_group.sonarqube.name\r\n  server_name                = azurerm_mssql_server.db-server.name\r\n  state                      = \"Enabled\"\r\n  storage_endpoint           = azurerm_storage_account.sonarqube.primary_blob_endpoint\r\n  storage_account_access_key = azurerm_storage_account.sonarqube.primary_access_key\r\n  email_account_admins       = true\r\n  retention_days             = 20\r\n}\r\n\r\nresource \"azurerm_mssql_server_vulnerability_assessment\" \"sonarqube\" {\r\n  server_security_alert_policy_id = azurerm_mssql_server_security_alert_policy.sonarqube.id\r\n  storage_container_path          = \"${azurerm_storage_account.sonarqube.primary_blob_endpoint}${azurerm_storage_container.db_vul_assess.name}/\"\r\n  storage_account_access_key      = azurerm_storage_account.sonarqube.primary_access_key\r\n\r\n  recurring_scans {\r\n    enabled                   = true\r\n    email_subscription_admins = true\r\n  }\r\n}","vector":[0.7,0.8,0.9]},{"@search.score":1.0,"id":"6","content":"resource \"azurerm_service_plan\" \"sonar\" {\r\n  name                   = \"eis-devtest-int-southwest-sonarqube-asp\"\r\n  resource_group_name    = azurerm_resource_group.sonarqube.name\r\n  location               = azurerm_resource_group.sonarqube.location\r\n  os_type                = \"Linux\"\r\n  sku_name               = \"P1v3\"\r\n  worker_count           = 2\r\n  zone_balancing_enabled = true\r\n  tags                   = local.devtesttags\r\n}\r\n\r\n/* resource \"azurerm_linux_web_app\" \"sonar\" {\r\n  name                = \"eis-devtest-int-southwest-sonarqube-app\"\r\n  resource_group_name = azurerm_resource_group.sonarqube.name\r\n  location            = azurerm_resource_group.sonarqube.location\r\n  service_plan_id     = azurerm_service_plan.sonar.id\r\n  #service_plan_id                                = data.azurerm_service_plan.linux.id\r\n  https_only                                     = true\r\n  public_network_access_enabled                  = false\r\n  ftp_publish_basic_authentication_enabled       = false\r\n  webdeploy_publish_basic_authentication_enabled = false\r\n  virtual_network_subnet_id                      = data.azurerm_subnet.app-subnet.id\r\n  tags                                           = local.devtesttags\r\n\r\n  connection_string {\r\n    name  = \"SQL\"\r\n    type  = \"SQLAzure\"\r\n    value = \"jdbc:sqlserver://${azurerm_mssql_server.db-server.fully_qualified_domain_name}:1433;database=${azurerm_mssql_database.db.name};user=${azurerm_mssql_server.db-server.administrator_login}@${azurerm_mssql_server.db-server.name};password=${azurerm_mssql_server.db-server.administrator_login_password};encrypt=true;trustServerCertificate=false;hostNameInCertificate=*.database.usgovcloudapi.net;loginTimeout=30;\"\r\n  }\r\n\r\n  site_config {\r\n    application_stack {\r\n      docker_image_name   = \"sonarqube:community\"\r\n      docker_registry_url = \"https://index.docker.io/v1\"\r\n    }\r\n  }\r\n\r\n  app_settings = {\r\n    SONAR_JDBC_URL                      = \"jdbc:sqlserver://${azurerm_mssql_server.db-server.fully_qualified_domain_name}:1433;database=${azurerm_mssql_database.db.name};user=${azurerm_mssql_server.db-server.administrator_login}@${azurerm_mssql_server.db-server.name};password=${azurerm_mssql_server.db-server.administrator_login_password};encrypt=true;trustServerCertificate=false;hostNameInCertificate=*.database.usgovcloudapi.net;loginTimeout=30;\"\r\n    SONAR_JDBC_USERNAME                 = azurerm_mssql_server.db-server.administrator_login\r\n    SONAR_JDBC_PASSWORD                 = azurerm_mssql_server.db-server.administrator_login_password\r\n    SONAR_ES_BOOTSTRAP_CHECKS_DISABLE   = \"true\"\r\n    WEBSITES_ENABLE_APP_SERVICE_STORAGE = \"false\"\r\n    DOCKER_ENABLE_CI                    = \"true\"\r\n  }\r\n} */","vector":[0.6,0.7,0.8]},{"@search.score":1.0,"id":"8","content":"resource \"azurerm_storage_account\" \"sonarqube\" {\r\n  name                            = \"sonarqubestrgacc\"\r\n  resource_group_name             = azurerm_resource_group.sonarqube.name\r\n  location                        = azurerm_resource_group.sonarqube.location\r\n  account_tier                    = \"Standard\"\r\n  account_replication_type        = \"RAGRS\"\r\n  min_tls_version                 = \"TLS1_2\"\r\n  allow_nested_items_to_be_public = false\r\n  tags                            = local.devtesttags\r\n\r\n  blob_properties {\r\n    delete_retention_policy {\r\n      days = 7\r\n    }\r\n  }\r\n}\r\n\r\nresource \"azurerm_storage_account_queue_properties\" \"sonarqube\" {\r\n  storage_account_id = azurerm_storage_account.sonarqube.id\r\n\r\n  logging {\r\n    version               = \"1.0\"\r\n    delete                = true\r\n    read                  = true\r\n    write                 = true\r\n    retention_policy_days = 10\r\n  }\r\n}\r\n\r\nresource \"azurerm_storage_container\" \"db_vul_assess\" {\r\n  name                  = \"dbvulassess\"\r\n  storage_account_id    = azurerm_storage_account.sonarqube.id\r\n  container_access_type = \"private\"\r\n}","vector":[0.8,0.9,0.1]},{"@search.score":1.0,"id":"1","content":"\r\nresource \"azurerm_container_group\" \"aci\" {\r\n  name                = \"sonarqube-aci\"\r\n  resource_group_name = azurerm_resource_group.sonarqube.name\r\n  location            = local.location\r\n  ip_address_type     = \"Private\"\r\n  # dns_name_label = \"sonar-vs\"\r\n  os_type        = \"Linux\"\r\n  restart_policy = \"Always\"\r\n  subnet_ids     = [data.azurerm_subnet.subnet.id]\r\n  tags           = local.devtesttags\r\n\r\n  exposed_port = [\r\n    {\r\n      port     = 9000\r\n      protocol = \"TCP\"\r\n    }\r\n  ]\r\n\r\n  container {\r\n    name   = \"sonarqube-container\"\r\n    image  = \"sonarqube:community\"\r\n    cpu    = 2\r\n    memory = 4\r\n\r\n    ports {\r\n      port     = 9000\r\n      protocol = \"TCP\"\r\n    }\r\n    environment_variables = {\r\n      SONAR_JDBC_URL                    = \"jdbc:sqlserver://${azurerm_mssql_server.db-server.fully_qualified_domain_name}:1433;database=${azurerm_mssql_database.db.name};user=${azurerm_mssql_server.db-server.administrator_login}@${azurerm_mssql_server.db-server.name};password=${azurerm_mssql_server.db-server.administrator_login_password};encrypt=true;trustServerCertificate=false;hostNameInCertificate=*.database.net;loginTimeout=30;\"\r\n      SONAR_JDBC_USERNAME               = azurerm_mssql_server.db-server.administrator_login\r\n      SONAR_JDBC_PASSWORD               = azurerm_mssql_server.db-server.administrator_login_password\r\n      SONAR_ES_BOOTSTRAP_CHECKS_DISABLE = \"true\"\r\n    }\r\n  }\r\n}","vector":[0.1,0.2,0.3]},{"@search.score":1.0,"id":"10","content":"terraform {\r\n  required_version = \"~> 1\"\r\n  required_providers {\r\n    azurerm = {\r\n      source  = \"hashicorp/azurerm\"\r\n      version = \"~> 4\"\r\n    }\r\n  }\r\n  backend \"azurerm\" {\r\n    resource_group_name  = \"EIS-PROD-INT-EAST-Terraform-RG\"\r\n    storage_account_name = \"eisprodinteasttfstate\"\r\n    container_name       = \"devtest\"\r\n    key                  = \"sonarqube.terraform.tfstate\"\r\n    subscription_id      = \"c0eb1fa5-****-****-****-********a1c9\"\r\n    tenant_id            = \"f7c49e36-****-****-****-********0bf6\"\r\n  }\r\n}\r\n\r\nprovider \"azurerm\" {\r\n  resource_provider_registrations = \"all\" #none\r\n  features {}\r\n  subscription_id = \"c0eb1fa5-****-****-****-********a1c9\"\r\n}","vector":[0.1,0.11,0.12]}]}